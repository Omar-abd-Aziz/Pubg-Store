<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Dashboard-Reports</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css" />
    <link rel="stylesheet" href="./css/framework.css" />
    <link rel="stylesheet" href="./css/master.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@300;500&display=swap" rel="stylesheet" />


    <link rel="icon" type="image/x-icon" href="./imgs/pubg icon.png">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.4/moment.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/moment-precise-range-plugin@1.3.0/moment-precise-range.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    
    <link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;700&display=swap" rel="stylesheet">


    <style>


      @font-face {
        font-family: myFirstFont;
        src: url(./Fonts/Ethnocentric.ttf);
      }

      
      /* Table Styles */

      .table-wrapper{
          box-shadow: 0px 35px 50px rgba( 0, 0, 0, 0.2 );
      }

      .fl-table {
          border-radius: 5px;
          font-size: 17px;
          font-weight: normal;
          border: none;
          border-collapse: collapse;
          width: 100%;
          max-width: 100%;
          white-space: nowrap;
          background-color: white;
      }

      .fl-table td{
          text-align: center;
          padding: 3px;
          border: 2px solid #0a1951;
      }


      .fl-table th {
          text-align: center;
          padding: 8px;
          border: 2px solid #0a1951;
      }


      .fl-table td {
          border-right: 1px solid #f8f8f8;
          font-size: 14px;
          font-family: 'Cairo';
      }


      .fl-table thead th {
          color: #ffffff;
          background: #0a1951;
      }

      .fl-table tr {
        border: 1px solid rgb(0, 0, 0);
      }

      /* Responsive */

      @media (max-width: 767px) {
          .HelloDiv {
              display: none;
          }
      }



      .CompanyName::before{
        content: "Digital vision for information technology";
        position: relative;
        bottom: -28px;
        left: 300px;
        font-family: myFirstFont;
        color: #397eaf;
        font-size: 13px;
      }


      .whoDetalls{
        margin: 10px;
        font-size: 20px;
        background: white;
        color: black;
        padding: 5px;
        border: 2px solid black;
        border-radius: 6px;
        text-align: end;
        font-weight: bold;
      }









    </style>

  </head>
  <body>
    <div class="page d-flex">
      
      <div class="content w-full">
        
        <!-- Start Head -->
        <div class="head bg-white between-flex" style="padding: 0px 10px 15px; background: #f1f5f9;">
          <div class="p-relative">
            <h1 class="p-relative" style="text-align: center;">التقارير</h1>
          </div>
        </div>
        <!-- End Head -->

        <div style="display: flex;align-items: center;justify-content: space-between;">
          <div>
            <button style="font-size: 18px; font-family:cairo; cursor:pointer; width: 120px; margin: 20px; border-radius: 10px; background: #0a1951; color: white; padding: 5px 0px; font-weight: 600;" class="printPage mainClassForSetColor">طباعة</button>
            <button class="mainClassForSetColor" style="font-size: 18px; font-family:cairo; cursor:pointer; margin: 20px; border-radius: 10px; background: #0a1951; color: white; padding: 5px 10px; font-weight: 600;">
              Total Price: 
              <span class="TotalPrice">0</span>
            </button>
            <button style="font-size: 18px; font-family:cairo; cursor:pointer; width: 120px; margin: 20px; border-radius: 10px; background: #0a1951; color: white; padding: 5px 0px; font-weight: 600;" class="reports mainClassForSetColor">التقرير</button>
          
            <button style="font-size: 18px; font-family:cairo; cursor:pointer; width: 120px; margin: 20px; border-radius: 10px; background: #0a1951; color: white; padding: 5px 0px; font-weight: 600;" class="mainClassForSetColor" onclick="ExportData()">excel</button>

          </div>
          

          <select class="whoDetalls">
            <option value="الكل">
                الكل
            </option>
            <option value="المكتب">
                المكتب
            </option>

          </select>

        </div>

        <div style="overflow: auto;">

          <div class="table-wrapper">
            <table class="fl-table">
                <thead class="mainClassForSetColor">
                <tr>
                    <th>التعديل</th>
                    <th>التاريخ</th>
                    <th>الحالة</th>
                    <th>نهاية العقد</th>
                    <th>صيغة العقد</th>
                    <th>بداية العقد</th>
                    <th>المبلغ</th>
                    <th>النشاط</th>
                    <th>المدينة</th>
                    <th>رقم جوال العميل</th>
                    <th>اسم العميل</th>
                    <th>رقم الطلب</th>
                    <th>#</th>
                </tr>
                </thead>

                <tbody id="AllOrders">
                
                <tbody>
            </table>
        </div>
          
        </div>

      </div>


      <!-- Start Sidebar can copy it to anthor file -->
      <div class="sidebar bg-white p-20 p-relative">
        <div class="HelloDiv">
          <i class="fa-regular fa-circle-user fa-fw" style="font-weight: bold;font-size: 50px;width: 100%;"></i>
          <h2>Hello <span id="AdminName" style="color: #397eaf"></span></h2>
        </div>
        <ul>
          
          <li>




            <a class="active d-flex align-center fs-14 c-black rad-6 p-10" style="display: flex; justify-content: end;" href="Dashboard-Store.html">
              <span style="font-weight: bold; font-size:20px;">المتجر</span>
              <i class="fa-regular fa-cart-shopping" style="font-weight: bold; font-size:20px; margin-left: 10px;"></i>
            </a>




            <a class="active d-flex align-center fs-14 c-black rad-6 p-10" style="display: flex; justify-content: end;" href="Dashboard-Orders.html">
              <p style="position: absolute; left: 35px; font-weight: bold;" class="NumberOfOrders">0</p>
              <span style="font-weight: bold; font-size:20px;">الطلبات</span>
              <i class="fa-regular fa-circle-user fa-fw" style="font-weight: bold; font-size:20px; margin-left: 10px;"></i>
            </a>

            <a class="active d-flex align-center fs-14 c-black rad-6 p-10" style="display: flex; justify-content: end;" href="Dashboard-OrdersActives.html">
              <span style="font-weight: bold; font-size:20px;">طلبات التفعيل</span>
              <i class="fa-solid fa-circle-check fa-fw" style="color: #1877f2;; font-weight: bold; font-size:20px; margin-left: 10px;"></i>
            </a>

            <a class="Orders-Accepted active d-flex align-center fs-14 c-black rad-6 p-10" style="display: flex; justify-content: end; cursor: pointer;" href="Dashboard-Accepted.html">
              <span style="font-weight: bold; font-size:20px;">العملاء</span>
              <i class="fa-regular fa-circle-user fa-fw" style="font-weight: bold; font-size:20px; margin-left: 10px; color: green; border-radius: 50%;"></i>
            </a>

            <a class="Orders-Accepted active d-flex align-center fs-14 c-black rad-6 p-10" style="display: flex; justify-content: end; cursor: pointer;" href="Dashboard-Archived.html">
              <span style="font-weight: bold; font-size:20px;">الارشيف</span>
              <i class="fa-solid fa-folder-open fa-fw" style="font-weight: bold; font-size:20px; margin-left: 10px; color: gray;"></i>
            </a>

            <a class="Orders-Accepted active d-flex align-center fs-14 c-black rad-6 p-10" style="display: flex; justify-content: end; cursor: pointer;" href="Dashboard-Technical-Support.html">
              <span style="font-weight: bold; font-size:20px;">الدعم الفني</span>
              <i class="fa-solid fa-headset" style="font-weight: bold; font-size:20px; margin-left: 10px; color: gray;"></i>
            </a>

            <a class="Orders-Accepted active d-flex align-center fs-14 c-black rad-6 p-10" style="display: flex; justify-content: end; cursor: pointer;" href="Dashboard-Suppliers.html">
              <span style="font-weight: bold; font-size:20px;">الموردين</span>
              <i class="fa-regular fa-truck-field" style="font-weight: bold; font-size:20px; margin-left: 10px; color: #397eaf;"></i>
            </a>

            <a class="Orders-Accepted active d-flex align-center fs-14 c-black rad-6 p-10" style="display: flex; justify-content: end; cursor: pointer;" href="Print-Page.html">
              <span style="font-weight: bold; font-size:20px;">عرض سعر</span>
              <i class="fa-solid fa-file-invoice-dollar" style="font-weight: bold; font-size:20px; margin-left: 15px; color: #20a2ed;"></i>
            </a>

            <a class="Orders-Accepted active d-flex align-center fs-14 c-black rad-6 p-10" style="display: flex; justify-content: end; cursor: pointer;" href="Dashboard-Reports.html">
                <span style="font-weight: bold; font-size:20px;">التقارير</span>
                <i class="fa-regular fa-book" style="font-weight: bold; font-size:20px; margin-left: 15px; color: #000000;"></i>
            </a>

            <a class="Orders-Accepted active d-flex align-center fs-14 c-black rad-6 p-10" style="display: flex; justify-content: end; cursor: pointer; background: rgba(137, 8, 8, 0.676); color: white;" id="logOut-digital">
              <span style="font-weight: bold; font-size:20px;">تسجيل الخروج</span>
              <i class="fas fa-sign-out-alt fa-fw" style="font-weight: bold; font-size:20px; margin-left: 10px; color: white;"></i>
            </a>

          </li>
          
        </ul>
      </div>
      <!-- End Sidebar can copy it to anthor file -->

    </div>
  </body>
  <script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <script src="https://www.gstatic.com/firebasejs/7.7.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/7.7.0/firebase-storage.js"></script>
  <script src="https://www.gstatic.com/firebasejs/7.7.0/firebase-database.js"></script>

  <script type="module">


  import { initializeApp } from 'https://www.gstatic.com/firebasejs/9.8.2/firebase-app.js';
  import { getFirestore, collection, getDocs,getDoc, setDoc, addDoc, doc,deleteDoc,onSnapshot } from 'https://www.gstatic.com/firebasejs/9.8.2/firebase-firestore.js';

  // TODO: Replace the following with your app's Firebase project configuration
  
  import { firebaseConfig } from './firebase.js';

  firebase.initializeApp(firebaseConfig);
  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  let X;

  async function getCit(db,X) {
  const citiesCol = collection(db,`${X}`);
  const citySnapshot = await getDocs(citiesCol);
  const cityList = citySnapshot.docs.map(doc => doc.data());
  return cityList;
  };


//////////////////////////////////////////////////////////////////////////




document.querySelector("body > div > div.sidebar.bg-white.p-20.p-relative > ul > li > a:nth-child(9)").style.background="rgb(176 206 226 / 85%)"









/*start login cods*/



/* 02 start get AllAccounts */

let AllAccounts;

await getCit(db, 'accounts').then(async (e) => {
  AllAccounts = e;
})

async function getUserDataWithId(id){
  return AllAccounts.find(e=>e.id==id);
}

/* 02 end get All Accounts */



/* 04 start check and get user doc */

let mainPersonData;
let docId = await localStorage.getItem("doc-digital-id");

if(docId!==null&&docId.trim()!==''){
    // document.querySelector('.profile-btn').dataset.personid=docId;
    mainPersonData=await getUserDataWithId(docId);

    if(mainPersonData.isAdmin==false){
      location.href="./Dashboard-notAdmin.html";
    };

    document.querySelector("#AdminName").textContent=`${mainPersonData.username}..`;
} else {
  location.href="./login/login.html"
}

/* 04 end check and get user doc */



document.querySelector("#logOut-digital").addEventListener("click",()=>{

  localStorage.setItem("doc-digital-id","");
  location.href="./login/login.html";

});


/*end login cods*/



/* start report section */


document.querySelector(".whoDetalls").addEventListener("change",(e)=>{

  let filterWith=e.srcElement.value;


  if((filterWith).trim()=="الكل"){

    let AllOrdersAccepted=AllOrders.filter(el=>el.price!==""&&el.price!=="0"&&el.isAccepted==true);
    toShowAllOrders(AllOrdersAccepted);

  } else if((filterWith).trim()=="المكتب"){

    let AllOrdersAccepted=AllOrders.filter(el=>el.price!==""&&el.price!=="0"&&el.isAccepted==true&&el.orderByUser==undefined);
    toShowAllOrders(AllOrdersAccepted);

  } else if((filterWith).trim()!=="المكتب"&&(filterWith).trim()!=="الكل"){
    
    let AllOrdersAccepted=AllOrders.filter(el=>el.price!==""&&el.price!=="0"&&el.isAccepted==true&&el.orderByUser==filterWith);
    toShowAllOrders(AllOrdersAccepted);

  };



});






function toShowAllOrders(x){
  document.querySelector("#AllOrders").innerHTML="";
  let TotalPrice=0;
  document.querySelector(".TotalPrice").innerHTML=`${TotalPrice}`;
  let i=0;


  x.forEach(el=>{
    let I=0;
    if((el.name).trim()!==""&&(el.phone).trim()!==""&&(el.active).trim()!==""&&(el.city).trim()!==""){
      i++;
      TotalPrice+=Number(el.price);
      document.querySelector("#AllOrders").innerHTML+=`
  
      <tr data-id="${el.id}" style="font-weight: 600;">
        <td class="Order-Editing">
  
          <a href="http://wa.me/${el.country_calling_code+Number(el.phone)}" target="_blank">
            <i title="واتساب" class="fa-brands fa-whatsapp" style="font-size: 20px; color: white; background: green; border-radius: 50%; padding: 4px 5px; cursor: pointer;"></i>
          </a>
             
        </td>
        <td class="Order-Date">${getDiffDate(el.orderDate)}</td>
        <td class="Order-Status">${(moment.preciseDiff(moment(), moment(`${el.endTime}`),true).firstDateWasLater)?"منتهي":"نشط"}</td>
        <td class="Order-End">${(el.endTime==undefined)?0:el.endTime}</td>
        <td class="Order-Shape">${(el.shape==undefined)?moment.preciseDiff(moment(`${el.startTime}`), moment(`${el.endTime}`)):el.shape}</td>
        <td class="Order-Start">${(el.startTime==undefined)?0:el.startTime}</td>
        <td class="Order-Price">${(el.price==undefined)?0:el.price}</td>
        <td class="Order-Active">
                      ${(el.active=="Store")?`
                        <a>
                          <i title="تفاصيل الطلب" class="fa-sharp fa-solid fa-circle-info OrderFromStore" data-id="${el.id}" data-store='${JSON.stringify(el.dataStore)}' style="font-size: 25px; color: rebeccapurple; background: white; border-radius: 50%; padding: 5px 5px; cursor: pointer;"></i>
                        </a>
                      `:`${el.active}`}
        </td>
        <td class="Order-City">${el.city}</td>
        <td class="Order-Phone">${el.phone}</td>
        <td class="Order-Name">${el.name}</td>
        <td class="">${el.orderNumber}</td>
        <td class="Order-Id">#${i}</td>
      </tr>
                 
      `;
    }

    document.querySelector(".TotalPrice").innerHTML=`${TotalPrice}`;
  });
};











function isOrderDateValid(date1,date2,mainDate){
  
  mainDate=mainDate.replaceAll('/', '-');
  mainDate=mainDate.trim();
  mainDate=mainDate.slice(0, 12);
  mainDate=mainDate.trim();


  let starts = moment(`${date1}`);
  let ends   = moment(`${date2}`);

  let diff1 = moment.preciseDiff(starts, mainDate, true);
  let diff2 = moment.preciseDiff(mainDate, ends, true);

  let isValid=false;
  if(diff1.firstDateWasLater==false&&diff2.firstDateWasLater==false){
    isValid=true;
  };


  return isValid;
}



document.querySelector(".reports").addEventListener("click",()=>{


  Swal.fire({
      title: 'قم باختيار التاريخ',
      html: `
      
      <input type="date" id="DateStarts" min="2022-01-01" style="padding: 5px; font-size: 16px;" >
      <br><br>
      <input type="date" id="DateEnds" min="2022-01-01" style="padding: 5px; font-size: 16px;">
      
      `,
      confirmButtonText: 'عرض',
  }).then((e)=>{
    let DateStarts = document.querySelector("#DateStarts").value;
    let DateEnds = document.querySelector("#DateEnds").value;

    DateStarts=DateStarts.trim();
    DateEnds=DateEnds.trim();

    if(DateStarts!==""&&DateEnds!==""){
      
      let filterWith = document.querySelector(".whoDetalls").value;

      if((filterWith).trim()=="الكل"){

        let AllOrdersAccepted=AllOrders.filter(el=>el.price!==""&&el.price!=="0"&&el.isAccepted==true);

        AllOrdersAccepted=AllOrdersAccepted.filter(el=>(isOrderDateValid(DateStarts,DateEnds,el.startTime))==true);
        

        toShowAllOrders(AllOrdersAccepted);

      } else if((filterWith).trim()=="المكتب"){

        let AllOrdersAccepted=AllOrders.filter(el=>el.price!==""&&el.price!=="0"&&el.isAccepted==true&&el.orderByUser==undefined&&isOrderDateValid(DateStarts,DateEnds,(el.startTime).trim())==true);
        toShowAllOrders(AllOrdersAccepted);

      } else if((filterWith).trim()!=="المكتب"&&(filterWith).trim()!=="الكل"){

        let AllOrdersAccepted=AllOrders.filter(el=>el.price!==""&&el.price!=="0"&&el.isAccepted==true&&el.orderByUser==filterWith&&isOrderDateValid(DateStarts,DateEnds,(el.startTime).trim())==true);
        toShowAllOrders(AllOrdersAccepted);

      };


    };

 
  });

});

/* end report section */












/* 1 start function to get data now */
function showDate(){
  
  const d = new Date();
  
  let year = d.getFullYear();
  let month = d.getMonth();
  let day = d.getDate();
  let hour = d.getHours();
  let mint = d.getMinutes();
  
  if(mint<10){
    mint=`0${mint}`
  }
  
  let dateNow;

  console.log(hour)

  if (hour>=12){
    
    dateNow= `
      ${year}/${month+1}/${day}
      => ${hour-12}:${mint} PM
      `;

  } else if (hour<=11){
    
      dateNow = `
      
      ${year}/${month+1}/${day}
         ${hour}:${mint} AM
      
      `;
  }
  return dateNow;
}

/* 1 end function to get data now */






const colRef= collection(db,"Persons");

let AllOrders;

await getCit(db,"Persons").then(AllOrdersNotSort=>{

  AllOrders=AllOrdersNotSort.sort(function(a, b) {
    return a.date - b.date;
  });

  AllOrders.reverse();
  let AllUsers=AllOrders.filter(el=>el.orderByUser!==undefined);
  let AllSuppliers=[];

  AllUsers.forEach((e)=>{
    AllSuppliers.push(e.orderByUser);
  });

  AllSuppliers=[...new Set(AllSuppliers)];

  AllSuppliers.forEach((e)=>{

    document.querySelector(".whoDetalls").innerHTML+=`
    <option value="${e}">
      ${e}
    </option>
          
    `;
  });

  let AllOrdersAccepted=AllOrders.filter(el=>el.price!==""&&el.price!=="0"&&el.isAccepted==true);
  toShowAllOrders(AllOrdersAccepted);

  document.querySelector(".NumberOfOrders").innerHTML="";

});





/* 2 start function to get differnce between data now */
function getDiffDate(oldDate){
 
    var starts = moment(`${oldDate}`);
    var ends   = moment();

    var duration = moment.duration(ends.diff(starts));

    // with ###moment precise date range plugin###
    // it will tell you the difference in human terms

    var diff = moment.preciseDiff(starts, ends, true); 
    // example: { "years": 2, "months": 7, "days": 0, "hours": 6, "minutes": 29, "seconds": 17, "firstDateWasLater":  false }


    // or as string:
    var diffHuman = moment.preciseDiff(starts, ends);
    // example: 2 years 7 months 6 hours 29 minutes 17 seconds

    let diffDate=diff;

    if(diffDate.years!==0){
        diffDate={
            "diffDateNum": diffDate.years,
            "diffDateName": "سنة",
        };
    } else if(diff.months!==0){
        diffDate={
            "diffDateNum": diffDate.months,
            "diffDateName": "شهر",
        };
    } else if(diff.days!==0){
        diffDate={
            "diffDateNum": diffDate.days,
            "diffDateName": "يوم",
        };
    } else if(diff.hours!==0){
        diffDate={
            "diffDateNum": diffDate.hours,
            "diffDateName": "ساعة",
        };
    } else if(diff.minutes!==0){
        diffDate={
            "diffDateNum": diffDate.minutes,
            "diffDateName": "دقيقة",
        };
    } else {
        diffDate={
            "diffDateNum": 0,
            "diffDateName": "الان",
        };
    }

    let stringDiffDate = `منذ ${diffDate.diffDateNum + " " + diffDate.diffDateName}`;
    // منذ 1 سنة

    if(diffDate.diffDateName=="الان"){
      stringDiffDate="الان";
    }
    
    // diffDate => json like {diffDateNum: 1, diffDateName: 'سنة'}

    return stringDiffDate;
}

// console.log(getDiffDate("2022/1/1 => 5:55 PM"));
/* 2 end function to get differnce between data now */


/* start print page */

// document.querySelector(".printPage").addEventListener("click",()=>{
  
// 		var printContents = document.querySelector("body > div > div.content.w-full").innerHTML;
// 		var originalContents = document.body.innerHTML;

// 		document.body.innerHTML = printContents;

// 		window.print();

// 		document.body.innerHTML = originalContents;

// });














/* 4 Start set Orders Accepted and orders archived*/

window.onclick=(e)=>{










/* start order detals btn*/
if([...e.target.classList].includes("OrderFromStore")){
  let arrayOfProducts = JSON.parse(e.target.dataset.store);
  console.log(arrayOfProducts);
  const div = document.createElement("div");
  let totalPrice=0;
  div.innerHTML=`<div class="shopping-cart">
    
    <div class="column-labels">
      <label class="product-image">الصورة</label>
      <label class="product-details">اسم المنتج</label>
      <label class="product-price">السعر</label>
      <label class="product-quantity">الكمية</label>
      <label class="product-line-price">الاجمالي</label>
    </div>
    
  </div>`;

  arrayOfProducts.forEach(e=>{
    totalPrice+=Number(e.productPrice)*Number(e.productAmount);
    div.innerHTML+=`
    
    <div class="product">
      <div class="product-image">
        <img src="${e.productImage}">
      </div>
      <div class="product-details">
        <div class="product-title">${e.productName}</div>
      </div>
      <div class="product-price">${e.productPrice}</div>
      <div class="product-quantity">
        ${e.productAmount}
      </div>
      <div class="product-line-price">${Number(e.productPrice)*Number(e.productAmount)}</div>
    </div>

    `;
  });

  div.innerHTML+=`
  <p>Total Price: ${totalPrice} $</p>
  `

  Swal.fire({
    html: div,
    confirmButtonText: 'ok',
    showCloseButton: true
  })

}
/* end order detals btn*/




}




















document.querySelector('.printPage').addEventListener('click', function() {

  let div = document.querySelector("body > div > div.content.w-full");
  html2canvas(div).then(
    function (canvas) {

      var link = document.createElement('a');
      link.download = 'filename.png';
      link.href = canvas.toDataURL()
      link.click();
      
  })

});
/* end print page */



</script>

<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.13.1/xlsx.full.min.js"></script> 
<script>
    function ExportData()
    {
        let filename='reports.xlsx';

        let AA=[]; 
        let arrayOfNames = [...document.querySelectorAll(".Order-Name")];
        let arrayOfPhones = [...document.querySelectorAll(".Order-Phone")];
        let arrayOfCitys = [...document.querySelectorAll(".Order-City")];

        console.log(arrayOfPhones[0].textContent)
        for (let i=0; i<arrayOfNames.length; i++){
          
          AA.push({name: arrayOfNames[i].textContent, phone: arrayOfPhones[i].textContent, city: arrayOfCitys[i].textContent,});
        }

        let data = AA;
        console.log(data);

        const worksheet = XLSX.utils.json_to_sheet(AA);
        const workbook = XLSX.utils.book_new();
        XLSX.utils.book_append_sheet(workbook, worksheet, "Dates");
        XLSX.writeFile(workbook,filename);
     }
</script>

</html>
